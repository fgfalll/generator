# Генератор Документів v4.0

![Версія](https://img.shields.io/badge/version-4.0-blue.svg)![Python](https://img.shields.io/badge/python-3.9%2B-blue.svg)![Framework](https://img.shields.io/badge/framework-PyQt6-green.svg)![Ліцензія](https://img.shields.io/badge/license-MIT-lightgrey.svg)

**Генератор Документів** — це потужний настільний застосунок для автоматизації створення документів Word (`.docx`) на основі табличних даних з файлів Excel (`.xlsx`) або CSV. Програма розроблена для значного прискорення робочих процесів, де потрібно генерувати велику кількість однотипних документів, таких як довідки, витяги, описи справ, листи та інші.

Версія 4.0 є повним переосмисленням архітектури та функціоналу, пропонуючи неперевершену гнучкість в обробці даних та покращений користувацький досвід.


## Основні Можливості

-   **Пакетна генерація:** Створюйте сотні унікальних документів за лічені хвилини на основі одного файлу даних та набору шаблонів.
-   **Потужні інструменти трансформації даних:**
    -   **Розділення колонок:** Легко розділяйте складні поля (напр., "Прізвище Ім'я По батькові") на окремі колонки за будь-яким роздільником (пробіл, кома).
    -   **Динамічне редагування:** Додавайте та видаляйте колонки безпосередньо в програмі.
    -   **Фільтрація:** Залишайте лише потрібні рядки даних за певними критеріями.
-   **Інтелектуальне співставлення колонок:** Візуальний інтерфейс для співставлення колонок з вашого файлу з полями у шаблоні. Програма автоматично знаходить збіги за назвами.
-   **Гнучке налаштування балів:** Спеціальне вікно для додавання колонок з числовими даними (оцінками, балами) з можливістю:
    -   Призначення кастомних ключів для шаблону (напр., `{{ ZNO_Math }}`).
    -   Автоматичної генерації суми прописом (`сто вісімдесят п'ять`).
    -   Призначення окремого ключа для суми прописом (напр., `{{ ZNO_Math_slova }}`).
-   **Керування шаблонами:** Використовуйте стандартні шаблони, додавайте власні або скануйте цілі папки для їх імпорту.
-   **Попередній перегляд:** Миттєво переглядайте завантажені та відредаговані дані перед генерацією.
-   **Консоль логування:** Відстежуйте всі кроки процесу в реальному часі.

## Що нового у версії 4.0 (Порівняння з v3.5)

Версія 4.0 — це значний крок уперед. Основна увага була приділена гнучкості обробки даних та модернізації інтерфейсу.

| Функція / Аспект | Версія 3.5 (застаріла) | **Версія 4.0 (теперішня)** |
| :--- | :--- | :--- |
| **Інтерфейс та UX** | Стандартний однофайловий скрипт на PyQt5. Функціональний, але не гнучкий. | **Сучасний, модульний інтерфейс на PyQt6.** Покращена навігація, окремі логічні блоки, додано теми оформлення. |
| **Трансформація даних** | **Відсутня.** Дані мали бути ідеально підготовлені в Excel перед завантаженням. | **Потужний вбудований функціонал.** Дозволяє розділяти, додавати, видаляти колонки та фільтрувати рядки безпосередньо в програмі. |
| **Співставлення колонок** | Базове вікно зі списком. Неможливо редагувати дані. | **Розширене вікно з інтегрованим попереднім переглядом.** Додано інструменти трансформації та можливість сформувати "ідеальну структуру" таблиці однією кнопкою. |
| **Робота з балами** | Простий вибір колонок з числовими даними. Ключі для шаблону генерувалися автоматично. | **Спеціалізоване вікно для налаштування.** Користувач може сам задавати ключі для числових значень та їх текстових відповідників, а також вмикати/вимикати генерацію прописом для кожної колонки. |
| **Архітектура коду** | Монолітний скрипт. Вся логіка (UI, обробка даних) в одному файлі. | **Модульна структура.** Логіка розділена на `backend.py` (обробка), `ui.py` (інтерфейс), `column_mapper.py` (діалоги), що спрощує підтримку та розширення. |
| **Залежності** | PyQt5, старіші версії бібліотек. | **Оновлено до PyQt6** та актуальних версій `pandas`, `docxtpl` та інших. |

## Встановлення та запуск

**Вимоги:** Python 3.9 або новіше.

1.  **Клонуйте репозиторій:**
    ```bash
    git clone https://your-repository-link.git
    cd document-generator
    ```

2.  **Створіть та активуйте віртуальне оточення (рекомендовано):**
    ```bash
    # Для Windows
    python -m venv venv
    venv\Scripts\activate

    # Для macOS/Linux
    python3 -m venv venv
    source venv/bin/activate
    ```

3.  **Встановіть необхідні бібліотеки:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Запустіть програму:**
    ```bash
    python main.py
    ```

## Інструкція з використання

1.  **Крок 1: Завантаження даних**
    -   Натисніть **"Виберіть Excel файл"** і виберіть ваш `.xlsx` або `.csv` файл.
    -   Виберіть потрібний аркуш зі списку. Дані з'являться у вікні попереднього перегляду.

2.  **Крок 2: Трансформація та Співставлення**
    -   Натисніть **"Співставлення колонок"**.
    -   У новому вікні спочатку **трансформуйте дані** за потреби. Наприклад, для колонки `Вступник` (що містить "ПІБ дата"):
        -   Використайте інструмент **"Розділення колонки"**, вказавши як роздільник пробіл, а як нові назви — `Прізвище,Ім'я,По батькові,Дата_народження`.
    -   Після цього у верхній частині вікна **співставте** ваші колонки (включно з новоствореними) з ідеальними полями програми.

3.  **Крок 3: Вибір Шаблонів**
    -   Виберіть один або декілька шаблонів `.docx` зі списку.
    -   Щоб додати власні шаблони, натисніть **"Додати"**. Вони будуть скопійовані в папку `Приклади` і стануть доступними для вибору.

4.  **Крок 4: Налаштування та Генерація**
    -   Якщо ваші документи мають містити числові бали, поставте галочку **"Додати бали з таблиці"**.
    -   Натисніть **"Налаштувати колонки балів"**, щоб відкрити вікно, де ви можете додати потрібні колонки та вказати ключі для шаблонів (напр., `{{ ball_ukr_mova }}` та `{{ ball_ukr_mova_slova }}`).
    -   Натисніть **"Створити документи"** і виберіть папку для збереження готових файлів.

## Структура Проєкту

```
/document-generator
|
|-- /Приклади/             # Папка для шаблонів .docx
|   |-- example_template.docx
|
|-- main.py                # Головний файл для запуску
|-- ui.py                  # Модуль головного вікна (PyQt6)
|-- backend.py             # Основна логіка: обробка файлів, генерація
|-- column_mapper.py       # Логіка вікна співставлення та трансформації
|-- score_mapper_dialog.py # Логіка вікна налаштування балів
|-- theme_manager.py       # Менеджер тем оформлення
|-- settings_dialog.py     # Вікно налаштувань
|-- requirements.txt       # Список залежностей
|-- Readme.md              # Цей файл
```